---
import UGCLayout from "@/layouts/UGCLayout.astro";
import { MainUGC } from "../../../ugc/MainUGC.tsx";
import UGCFooter from "@/layouts/UGCFooter.astro";
import { API_ORIGIN } from "@/lib/enviroment";

const { slug } = Astro.params;

let website: any;

try {
  const response = await fetch(`${API_ORIGIN}/public/website?slug=${slug}`);
  if (!response.ok) throw new Error("Website not found");
  website = await response.json();
} catch (error) {
  console.error(error);
  return Astro.rewrite("/es");
}
---

<UGCLayout website={website}>
  <MainUGC client:load website={website} apiOrigin={API_ORIGIN} slug={slug!} />
  <UGCFooter website={website} />
</UGCLayout>
